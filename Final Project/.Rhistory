knitr::opts_chunk$set(echo = TRUE)
# Install required packages if not already installed
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(c("SNPRelate", "GENESIS"))
if(!require("SNPRelate", quietly = TRUE))
install.packages("SNPRelate")
if(!require("GENESIS", quietly = TRUE))
install.packages("GENESIS")
# Install required packages if not already installed
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(c("SNPRelate", "GENESIS"))
if(!require("SNPRelate", quietly = TRUE))
install.packages("SNPRelate")
if(!require("GENESIS", quietly = TRUE))
install.packages("GENESIS")
# Load required libraries
library(SNPRelate)
library(GENESIS)
# Convert PLINK format to GDS format
snpgdsPED2GDS("Dataset/input.ped", "Dataset/input.map", "Dataset/genotype.gds")
# Open the GDS file
genofile <- snpgdsOpen("Dataset/genotype.gds")
# Load required libraries
library(SNPRelate)
library(GENESIS)
# Convert PLINK format to GDS format
snpgdsPED2GDS("Dataset/input.ped", "Dataset/input.map", "Dataset/genotype.gds")
knitr::opts_chunk$set(echo = TRUE)
# Load required libraries
library(SNPRelate)
library(GENESIS)
# Convert PLINK format to GDS format
snpgdsPED2GDS("Dataset/input.ped", "Dataset/input.map", "Dataset/genotype.gds")
# Open the GDS file
genofile <- snpgdsOpen("Dataset/genotype.gds")
# Calculate kinship using MLE method
# First, perform identity-by-descent (IBD) analysis with MLE
ibd_mle <- snpgdsIBDMLE(genofile,
num.thread = 2,  # Adjust based on your CPU cores
mle = TRUE,      # This specifies MLE method
autosome.only = FALSE)  # Set TRUE if you only want autosomes
# Load required libraries
library(SNPRelate)
library(GENESIS)
# Convert PLINK format to GDS format
snpgdsPED2GDS("Dataset/input.ped", "Dataset/input.map", "Dataset/genotype.gds")
